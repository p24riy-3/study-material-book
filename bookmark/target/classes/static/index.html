<!DOCTYPE html>
<html>
<head>
    <title>Study Materials</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            min-height: 100vh;
            background:
                linear-gradient(rgba(255,255,255,0.4), rgba(255,255,255,0.15)),
                url("https://images.unsplash.com/photo-1512820790803-83ca734da794");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        /* ===== DARK MODE ===== */
body.dark {
    min-height: 100vh;
    background:
        linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.65)),
        url("https://images.unsplash.com/photo-1512820790803-83ca734da794");
    color: #fff;
    background-size: cover;
            background-position: center;
            background-attachment: fixed;
}

body.dark .navbar-custom {
    background: rgba(0,0,0,0.6);
    border-color: #fff;
}

body.dark .nav-link-custom,
body.dark .nav-link-home,
body.dark .navbar-brand {
    color: #fff !important;
}
body.dark .form-control {
    background: #000 !important;
    color: white !important;
    border-color: #fff !important;
    
}
body.dark .form-control::placeholder {
    color: rgba(255,255,255,0.8);
    text-shadow: 0 0 4px rgba(255,255,255,0.25);
}


body.dark .card {
    background: rgba(0,0,0,0.6);
    color: #fff;
    border-color: #fff;
}


/* Toggle button */
.toggle-btn {
    background: none;
    border: none;
    font-size: 1.3rem;
    cursor: pointer;
    color: #000;
}

body.dark .toggle-btn {
    color: #fff;
}

/* Bigger cards */
.card {
    min-height: 360px;   /* ðŸ‘ˆ increased height */
}

        .nav-link-home {
    text-decoration: none;
    color: #000;
    font-weight: 600; /* slightly bold */
    padding: 6px 10px;
    transition: color 0.2s ease;
}
.card-footer {
    color: #000;
}

body.dark .card-footer {
    color: #ffffff;
}

.nav-link-home:hover {
    color: #000;
}

        .navbar-custom {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(4px);
            border-bottom: 1.5px solid #000;
        }

        .navbar-custom.navbar-scrolled {
            background: rgba(70, 81, 99, 0.75);
        }

        .nav-link-custom {
            color: #000;
            font-weight: 600;
            text-decoration: none;
            padding: 6px 10px;
            transition: color 0.2s ease, background 0.2s ease;
        }

        .nav-link-custom:hover {
            color: #000;
            
            border-radius: 6px;
        }

        .card {
            border-radius:12px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter:blur(6px);
            transition:transform 0.2s ease,box-shadow 0.2s ease;
            min-height: 270px;
            border: 1.5px solid #000;
            position: relative;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: #000;
        }
        
        .delete-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 0.9rem;
        }
        .no-result-text {
    color: #000;
}

body.dark .no-result-text {
    color: #fff;
}

    </style>
</head>
<script>
function toggleTheme() {
    document.body.classList.toggle("dark");

    if (document.body.classList.contains("dark")) {
        localStorage.setItem("theme", "dark");
    } else {
        localStorage.setItem("theme", "light");
    }

    updateIcon();
}

function updateIcon() {
    const icon = document.querySelector("#themeIcon i");
    if (!icon) return;

    if (document.body.classList.contains("dark")) {
        icon.className = "bi bi-sun-fill";
    } else {
        icon.className = "bi bi-moon-fill";
    }
}
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const savedTheme = localStorage.getItem("theme");

    if (savedTheme === "dark") {
        document.body.classList.add("dark");
    }

    updateIcon();
});
</script>

<body class="bg-light">

<nav class="navbar navbar-dark navbar-custom fixed-top">
    <div class="container-fluid">
        <span class="navbar-brand" style="font-weight:700;color:black;font-size:20px;">
            
            Study Material Book
        </span>

        <div class="d-flex gap-2">
            <div class="d-flex gap-3 align-items-center">
    
    <!-- Add link -->
    <a href="add.html" class="nav-link-custom">
        <b><i class="bi bi-plus-circle me-1"></i> Add</b>
    </a>

                <a href="home.html" class="nav-link-home">
    <i class="bi bi-house-door-fill me-1"></i> Home
</a>
 <button class="toggle-btn" onclick="toggleTheme()" id="themeIcon">
        <i class="bi bi-moon-fill"></i>
    </button>
            </div>
        </div>
    </div>
</nav>
<div style="height:70px;"></div>




<div class="container mt-4">
    <form id="searchForm">
        <div class="input-group mb-4" style="max-width:1290px; margin:auto;">
            <input 
                class="form-control" 
                id="tag" 
                placeholder="Enter tag" 
                required
                style="
                    border:1.5px solid #000;
                    background: rgba(255, 255, 255, 0.6);
                "
            >
            <button 
                class="btn btn-success" 
                type="submit"
                style="
                    border:1.5px solid #000;
                    font-weight:600;
                "
            >
                <i class="bi bi-search"></i> Search
            </button>
        </div>
    </form>
</div>

<div class="row" id="results"></div>


<div class="container mt-4">
    <div class="row" id="materials"></div>
</div>

<script>
const materialsRow = document.getElementById("materials");
const searchInput = document.getElementById("tag");

/* Load all materials */
function loadAllMaterials() {
    fetch("/materials")
        .then(res => res.json())
        .then(data => renderMaterials(data));
}

/* Render materials to the DOM */
function renderMaterials(data) {
    materialsRow.innerHTML = "";
    if (data.length === 0) {
       materialsRow.innerHTML = `
<p class="fw-bold text-center no-result-text">
    No materials found
</p>`;

        return;
    }

    data.forEach(m => {
        materialsRow.innerHTML += `
        <div class="col-md-4 mb-3" id="material-col-${m.id}">
            <div class="card shadow h-100" id="material-${m.id}">
                <button class="btn btn-danger btn-sm delete-btn" onclick="deleteMaterial(${m.id})">
                    <i class="bi bi-trash"></i> Delete
                </button>
                <div class="card-body">
                    <h5 class="card-title">${m.title}</h5>
                    <p class="card-text">${m.description || ""}</p>
                    ${m.youtubeLink ? `<a href="${m.youtubeLink}" target="_blank" class="btn btn-danger btn-sm mb-1">YouTube</a>` : ""}
                    ${m.pdfPath ? `<a href="${m.pdfPath}" target="_blank" class="btn btn-primary btn-sm mb-1">PDF</a>` : ""}
                    ${m.noteText ? `<p class="mt-2"><b>Notes:</b> ${m.noteText}</p>` : ""}
                </div>
                <div class="card-footer">
    Tags: ${m.tags || "â€”"}
</div>

            </div>
        </div>`;
    });
}

/* Delete material dynamically */
function deleteMaterial(id) {
    if (!confirm("Are you sure you want to delete this material?")) return;

    fetch(`/materials/delete?id=${id}`, { method: "DELETE" })
        .then(res => {
            if(res.ok) {
                // Remove from DOM
                const card = document.getElementById(`material-col-${id}`);
                if (card) card.remove();
            } else {
                alert("Failed to delete material.");
            }
        });
}

/* Initial load */
loadAllMaterials();

/* Search submit */
document.getElementById("searchForm").addEventListener("submit", function (e) {
    e.preventDefault();
    let tag = searchInput.value.trim();

    if (tag === "") {
        loadAllMaterials();
        return;
    }

    fetch(`/materials/search?tag=${tag}`)
        .then(res => res.json())
        .then(data => renderMaterials(data));
});

/* Show all materials when search cleared */
searchInput.addEventListener("input", () => {
    if (searchInput.value.trim() === "") {
        loadAllMaterials();
    }
});
</script>

<script>
window.addEventListener("scroll", () => {
    const nav = document.querySelector(".navbar-custom");
    nav.classList.toggle("navbar-scrolled", window.scrollY > 50);
});
</script>





</body>
</html>
